<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title>Oyster</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link href="static/css/solarized.css" media="all" rel="stylesheet" type="text/css" />
    </head>
    <body>
        <!--[if lt IE 7]>
            <p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
        <![endif]-->

        <h1>Oyster</h1>
        <iframe src="http://ghbtns.com/github-btn.html?user=birknilson&repo=oyster&type=watch&count=true&size=large"
                allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>

        <div id="readme">
            <h1>Oyster: Get 'em pearls</h1>

<p>Oyster is a Python module for parsing shell commands. Unlike awesome modules such as docopt, optparse &amp; argpare the
primary intention of Oyster is not to parse the arguments passed to a single application - although it is capable of that too.
The main objective is rather to parse any given shell command whether it be a chain of multiple commands or not.</p>

<ul>
<li><a href="#demo">Demo</a></li>
<li><a href="#installation">Installation</a></li>
<li><a href="#development">Development</a></li>
<li><a href="#features">Features</a>
<ul>
<li><a href="#chains">Chains</a></li>
<li><a href="#commands">Commands</a></li>
<li><a href="#redirects">Redirects</a></li>
</ul></li>
<li><a href="#caveats">Caveats</a></li>
<li><a href="#documentation">Documentation</a></li>
<li><a href="#license">License</a></li>
</ul>

<h2>Demo</h2>

<div class="highlight"><pre><span class="kn">import</span> <span class="nn">oyster</span>

<span class="n">chain</span> <span class="o">=</span> <span class="n">oyster</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="s">&#39;pip search -vvv --timeout=5 flask | grep session | less&#39;</span><span class="p">)</span>
<span class="k">print</span> <span class="nb">len</span><span class="p">(</span><span class="n">chain</span><span class="p">)</span>  <span class="c"># ==&gt; 3</span>

<span class="n">pip</span><span class="p">,</span> <span class="n">grep</span><span class="p">,</span> <span class="n">less</span> <span class="o">=</span> <span class="n">chain</span>

<span class="k">print</span> <span class="n">pip</span><span class="o">.</span><span class="n">has_option</span><span class="p">(</span><span class="s">&#39;--timeout&#39;</span><span class="p">)</span>  <span class="c"># ==&gt; True</span>
<span class="k">print</span> <span class="n">pip</span><span class="o">.</span><span class="n">get_option_values</span><span class="p">(</span><span class="s">&#39;--timeout&#39;</span><span class="p">)</span>  <span class="c"># ==&gt; [&#39;5&#39;]</span>
<span class="k">print</span> <span class="n">pip</span><span class="o">.</span><span class="n">get_option_count</span><span class="p">(</span><span class="s">&#39;-v&#39;</span><span class="p">)</span>  <span class="c"># ==&gt; 3</span>
<span class="k">print</span> <span class="n">pip</span><span class="o">.</span><span class="n">arguments</span>  <span class="c"># ==&gt; (&#39;search&#39;, &#39;--timeout=5&#39;, &#39;flask&#39;)</span>

<span class="k">print</span> <span class="n">grep</span>  <span class="c"># ==&gt; &#39;grep session&#39;</span>
<span class="k">print</span> <span class="n">less</span>  <span class="c"># ==&gt; &#39;less&#39;</span>

<span class="n">chain</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s">&#39;less&#39;</span><span class="p">)</span>
<span class="k">print</span> <span class="n">chain</span>  <span class="c"># ==&gt; &#39;pip search -vvv --timeout=5 flask | grep session&#39;</span>

<span class="n">chain</span> <span class="o">+=</span> <span class="s">&#39;date -u&#39;</span>
<span class="k">print</span> <span class="n">chain</span>  <span class="c"># ==&gt; &#39;pip search -vvv --timeout=5 flask | grep session; date -u&#39;</span>
<span class="n">utc_date</span> <span class="o">=</span> <span class="n">chain</span><span class="p">[</span><span class="n">chain</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s">&#39;date -u&#39;</span><span class="p">)]</span>
<span class="k">print</span> <span class="n">utc_date</span>  <span class="c"># ==&gt; &#39;date -u&#39;</span>
<span class="k">print</span> <span class="n">utc_date</span><span class="o">.</span><span class="n">get_option_values</span><span class="p">(</span><span class="s">&#39;-u&#39;</span><span class="p">)</span>  <span class="c"># ==&gt; [True]</span>
</pre></div>

<h2>Installation</h2>

<p>Installation instructions coming soon once the <code>setup.py</code> has been written.</p>

<h2>Development</h2>

<p>Want to help out? Awesome! Here is what you need to do:</p>

<p><strong>Fork the repository</strong></p>

<p><strong>Clone the repository</strong></p>

<pre><code>git clone git@github.com:&lt;your_github_username&gt;/oyster.git ~/your/dev/env/oyster
</code></pre>

<p><strong>Create a virtual environment for Oystr</strong></p>

<pre><code>mkvirtualenv oyster
cd ~/your/dev/env/oyster
pip install -r development-requirements.txt
</code></pre>

<p><strong>Run the tests</strong></p>

<pre><code>python tests.py
</code></pre>

<p><strong>Submit a pull-request:</strong>
Once you are done - all you need to do is follow the standard procedure for creating a pull-request. Thanks in advance!</p>

<h2>Features</h2>

<p>####Chains:</p>

<div class="highlight"><pre><span class="kn">import</span> <span class="nn">oyster</span>

<span class="n">chain</span> <span class="o">=</span> <span class="n">oyster</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="s">&#39;cat /var/log/system.log | grep kernel &gt;&gt; system_kernel.log 2&gt;&gt; errors.log&#39;</span><span class="p">)</span>
<span class="n">cat</span><span class="p">,</span> <span class="n">grep</span> <span class="o">=</span> <span class="n">chain</span>
<span class="k">print</span> <span class="n">cat</span>  <span class="c"># ==&gt; &#39;cat /var/log/system.log&#39;</span>
<span class="k">print</span> <span class="n">grep</span>  <span class="c"># ==&gt; &#39;grep kernel &gt;&gt; system_kernel.log 2&gt;&gt; errors.log&#39;</span>
</pre></div>

<p>####Commands:</p>

<div class="highlight"><pre><span class="kn">import</span> <span class="nn">oyster</span>

<span class="n">command</span> <span class="o">=</span> <span class="n">oyster</span><span class="o">.</span><span class="n">Command</span><span class="p">([</span><span class="s">&#39;cat&#39;</span><span class="p">,</span> <span class="s">&#39;-n&#39;</span><span class="p">,</span> <span class="s">&#39;foo.txt&#39;</span><span class="p">])</span>
<span class="k">print</span> <span class="n">command</span>  <span class="c"># ==&gt; &#39;cat -n foo.txt&#39;</span>
<span class="k">print</span> <span class="n">command</span><span class="o">.</span><span class="n">program</span>  <span class="c"># ==&gt; &#39;cat&#39;</span>
<span class="k">print</span> <span class="n">command</span><span class="o">.</span><span class="n">arguments</span>  <span class="c"># ==&gt; (&#39;-n&#39;, &#39;foo.txt&#39;)</span>
<span class="k">print</span> <span class="n">command</span><span class="o">.</span><span class="n">has_option</span><span class="p">(</span><span class="s">&#39;-n&#39;</span><span class="p">)</span>  <span class="c"># ==&gt; True</span>
<span class="k">print</span> <span class="n">command</span><span class="o">.</span><span class="n">get_option_values</span><span class="p">(</span><span class="s">&#39;-n&#39;</span><span class="p">)</span>  <span class="c"># ==&gt; [&#39;foo.txt&#39;]  (See &quot;Caveats&quot; about this)</span>
<span class="k">print</span> <span class="n">command</span><span class="o">.</span><span class="n">get_option_count</span><span class="p">(</span><span class="s">&#39;-n&#39;</span><span class="p">)</span>  <span class="c"># ==&gt; 1</span>
<span class="k">print</span> <span class="n">command</span><span class="o">.</span><span class="n">get_options</span><span class="p">()</span>  <span class="c"># ==&gt; {&#39;-n&#39;: [&#39;foo.txt&#39;]}  (See &quot;Caveats&quot; about this)</span>
</pre></div>

<p>####Redirects:</p>

<div class="highlight"><pre><span class="kn">import</span> <span class="nn">oyster</span>

<span class="n">chain</span> <span class="o">=</span> <span class="n">oyster</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="s">&#39;cat /var/log/system.log | grep kernel &gt;&gt; system_kernel.log 2&gt;&gt; errors.log&#39;</span><span class="p">)</span>
<span class="k">print</span> <span class="n">chain</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">redirects</span>  <span class="c"># ==&gt; ()</span>
<span class="k">print</span> <span class="n">chain</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">redirects</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c"># ==&gt; &gt;&gt; system_kernel.log</span>
<span class="k">print</span> <span class="n">chain</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">redirects</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="n">oyster</span><span class="o">.</span><span class="n">STDOUT</span>  <span class="c"># ==&gt; True</span>
<span class="k">print</span> <span class="n">chain</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">redirects</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">destination</span> <span class="o">==</span> <span class="s">&#39;system_kernel.log&#39;</span>  <span class="c"># ==&gt; True</span>
<span class="k">print</span> <span class="n">chain</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">redirects</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">mode</span>  <span class="c"># ==&gt; &#39;a&#39;</span>
<span class="k">print</span> <span class="n">chain</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">redirects</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>  <span class="c"># ==&gt; 2&gt;&gt; errors.log</span>
<span class="k">print</span> <span class="n">chain</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">redirects</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">is_source_stderr</span><span class="p">()</span>  <span class="c"># ==&gt; True</span>
<span class="k">print</span> <span class="n">chain</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">redirects</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">is_destination_stdfd</span><span class="p">()</span>  <span class="c"># ==&gt; False</span>
</pre></div>

<h2>Caveats</h2>

<ul>
<li>The string passed to <code>oyster.parse</code> can differ from <code>str(command)</code> since the latter is generated using <code>subprocess.list2cmdline</code> which can cause different quotations.</li>
<li><code>Command(['cat', '-n', 'foo.txt']).get_option_values('-n')</code> will always return a <code>list</code> since options can be repeated.</li>
<li><code>Command(['curl', '-v', 'http://localhost']).get_option_values('-v')</code> will return <code>['http://localhost']</code>. Whether this is true or not is up to the program executed, i.e <code>curl</code> in this instance.</li>
</ul>

<h2>Documentation</h2>

<p>The Oyster documentation is available <a href="http://birknilson.github.io/oyster/documentation/">here</a>.
Currently, this is a work in progress and a complete documentation will be available within a few days.</p>

<h2>License</h2>

<p>Oyster is licensed under a three clause BSD License which can read in the included <a href="https://github.com/birknilson/oyster/blob/master/LICENSE">LICENSE</a> file.</p>

        </div>

        <a href="https://github.com/birknilson/oyster" class="github">
            <img style="position: absolute; top: 0; right: 0; border: 0;" src="http://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png" alt="Fork me on GitHub" class="github">
        </a>
        <!-- Google Analytics: change UA-XXXXX-X to be your site's ID. -->
        <!--
        <script>
            (function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=
            function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;
            e=o.createElement(i);r=o.getElementsByTagName(i)[0];
            e.src='//www.google-analytics.com/analytics.js';
            r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));
            ga('create','UA-XXXXX-X');ga('send','pageview');
        </script>
        -->
    </body>
</html>
